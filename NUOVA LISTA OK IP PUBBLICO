NUOVA LISTA OK IP PUBBLICO

CLIENT-200:
	ip addr add 192.168.200.2/24 dev eth1 
	ip route add default via 192.168.200.1

R101:
	interface eth0
 	ip address 10.0.22.2/30
	exit
	!
	interface eth1
 	ip address 10.0.23.1/30
	exit
	!
	interface lo
 	ip address 1.1.0.1/8
 	ip address 1.255.0.1/32
	exit
	!

	router bgp 100
 		neighbor 1.255.0.2 remote-as 100
 		neighbor 1.255.0.2 update-source 1.255.0.1
 		neighbor 10.0.22.1 remote-as 200
 	!
 	address-family ipv4 unicast
  		network 1.0.0.0/8
  		neighbor 1.255.0.2 next-hop-self
 	exit-address-family
	exit
	!

	router ospf
 		ospf router-id 1.255.0.1
 		network 1.1.0.0/16 area 0
 		network 1.255.0.1/32 area 0
 		network 10.0.23.0/30 area 0
	exit
	!

R201:
	interface eth0
	 ip address 10.0.22.1/30
	exit
	!
	interface eth1
	 ip address 10.0.21.2/30
	exit
	!
	interface lo
	 ip address 2.1.0.1/8
	 ip address 2.255.0.1/32
	exit
	!
	router bgp 200
	 neighbor 2.255.0.2 remote-as 200
	 neighbor 2.255.0.2 update-source 2.255.0.1
	 neighbor 10.0.22.2 remote-as 100
	 !
	 address-family ipv4 unicast
	  network 2.0.0.0/8
	  neighbor 2.255.0.2 next-hop-self
	 exit-address-family
	exit
	!
	router ospf
	 ospf router-id 2.255.0.1
	 network 2.0.0.0/8 area 0
	 network 2.255.0.1/32 area 0
	 network 10.0.21.0/30 area 0
	exit
	!

R202:
	interface eth0
	 ip address 2.0.23.1/30
	exit
	!
	interface eth1
	 ip address 10.0.21.1/30
	exit
	!
	interface lo
	 ip address 2.2.0.1/16
	 ip address 2.255.0.2/32
	exit
	!
	router bgp 200
	 neighbor 2.0.23.2 remote-as 200
	 neighbor 2.0.23.2 update-source 2.2.0.1
	 neighbor 2.255.0.1 remote-as 200
	 neighbor 2.255.0.1 update-source 2.255.0.2
	 !
	 address-family ipv4 unicast
	  network 2.0.0.0/8
	  network 2.2.0.0/16
	  neighbor 2.0.23.2 next-hop-self
	  neighbor 2.255.0.1 next-hop-self
	 exit-address-family
	exit
	!
	router ospf
	 ospf router-id 2.255.0.2
	 network 2.0.0.0/8 area 0
	 network 2.0.23.0/30 area 0
	 network 2.2.0.0/16 area 0
	 network 2.255.0.2/32 area 0
	 network 10.0.21.0/30 area 0
	exit
	!

	sysctl -w net.ipv4.ip_forward=1


R203:
	ip addr add 192.168.200.1/24 dev eth1
	ip addr add 2.0.23.2/30 dev eth0
	ip route add default via 2.0.23.1

	sysctl -w net.ipv4.ip_forward=1

	export LAN=eth1 #comandi per specificare il nome associato alle interfacce
 	export NET=eth0     
 		
 	#regola1 permette solo il traffico iniziato dalla lan verso l'as200 e oltre
 	#regola2 permette il traffico associato a connessione gia stabilite
 	iptables -A FORWARD -i $LAN -o $NET -j ACCEPT
	iptables -A FORWARD -m state --state ESTABLISHED -j ACCEPT

	iptables -t nat -A POSTROUTING -o $NET -j MASQUERADE #abilita il NAT mascherando l'indirizzo vero con quello di $NET
